# 5. Discovery

Fast DDS 作为一种 Data Distribution Service (DDS) 实现，提供了发现机制，允许自动在多个 DomainParticipant 之间查找并匹配 DataWriter 和 DataReader，使它们能够开始共享数据。对于所有这些机制，发现过程都分为两个阶段进行。

## 5.1. Discovery phases

1. **Participant Discovery Phase（PDP）**：在此阶段，`DomainParticipant` 实例相互确认彼此的存在。为此，每个 `DomainParticipant` 会定期发送通告消息，这些消息会指明（包括但不限于）用于接收元数据和用户数据流入的单播地址（IP 与端口）。当两个 `DomainParticipant` 属于同一 DDS 域时，它们会被视为匹配。默认情况下，通告消息通过由 `domainId` 计算得出的预定义组播地址与端口发送。此外，也可以指定一组地址以通过单播发送通告（参见 Initial peers）。还可以配置此类通告的发送周期（参见 Discovery Configuration）。

2. **Endpoint Discovery Phase（EDP）**：在此阶段，`DataWriter` 与 `DataReader` 相互发现。为此，`DomainParticipant` 利用 PDP 阶段建立的通信通道相互交换有关其 `DataWriter` 与 `DataReader` 的信息。这些信息包含（但不限于）`Topic` 与数据类型（参见 Topic）。要使两个端点匹配，它们的 `Topic` 与数据类型必须一致。一旦 `DataWriter` 与 `DataReader` 匹配完成，它们即可开始发送／接收用户数据流。

Important：可以在 PDP 阶段传输有关运行 `DomainParticipant` 的主机、用户和进程（物理信息）。有关如何配置要传输的物理数据的更多信息，请参阅 Physical Data in Discovery Information 节。

## 5.2. Discovery mechanisms

Fast DDS 提供以下几种发现机制：

- **Simple Discovery**：这是默认机制。它在 PDP 和 EDP 两个阶段都遵循 RTPS 标准，因此可以与任何其他 DDS 和 RTPS 实现兼容。

- **Static Discovery**：该机制在 PDP 阶段使用 RTPS 标准中指定的 Simple Participant Discovery Protocol（SPDP），但当所有 `DataWriter` 和 `DataReader` 的 IP 与端口、数据类型和 Topic 事先已知时，可以跳过 Simple Endpoint Discovery Protocol（SEDP）阶段。

- **Discovery Server**：该机制使用集中式发现架构，一个被称为 Server 的 `DomainParticipant` 作为元流量发现的枢纽。

- **Manual Discovery**：该机制仅兼容 RTPS 层。它会禁用 PDP，允许用户使用任意外部的元信息通道手动匹配和解除匹配 `RTPSParticipant`、`RTPSReader` 与 `RTPSWriter`。因此，用户必须访问由 `DomainParticipant` 实现的 `RTPSParticipant` 并直接匹配 RTPS 实体。

## 5.3. Discovery settings

以下各节将列出并说明前面所定义的每种发现机制可用的配置选项，以及如何定义 `DomainParticipantListener` 的发现回调函数。
